<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BS Finance Mobile</title>
    <style>
        :root {
            --primary: #10b981; --danger: #f43f5e; --bg: #0b0f19;
            --card: #1c2237; --text: #ffffff; --text-dim: #94a3b8;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 80px; overflow-x: hidden; }
        
        /* App Header */
        header { padding: 20px; background: linear-gradient(to bottom, #1c2237, var(--bg)); text-align: right; }
        .user-greet { font-size: 0.9rem; color: var(--text-dim); }
        .brand { font-size: 1.4rem; font-weight: 800; color: var(--primary); margin: 0; }

        /* Summary Card */
        .balance-card { background: linear-gradient(135deg, #2563eb, #6366f1); margin: 0 20px; padding: 25px; border-radius: 24px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        .balance-label { font-size: 0.8rem; opacity: 0.8; }
        .balance-val { font-size: 2.2rem; font-weight: 800; margin: 5px 0; }

        /* Stats Grid */
        .quick-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 20px; }
        .stat-box { background: var(--card); padding: 15px; border-radius: 18px; display: flex; align-items: center; gap: 10px; }
        .icon-circle { width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; }

        /* Tabs Section */
        .view-section { display: none; padding: 0 20px; animation: fadeIn 0.3s ease; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Transaction List */
        .list-title { display: flex; justify-content: space-between; align-items: center; margin: 10px 0; }
        .tx-item { background: var(--card); padding: 15px; border-radius: 18px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .tx-info h4 { margin: 0; font-size: 1rem; }
        .tx-info small { color: var(--text-dim); font-size: 0.75rem; }

        /* Forecast */
        .forecast-card { background: rgba(16, 185, 129, 0.1); border: 1px solid var(--primary); padding: 15px; border-radius: 18px; margin-bottom: 10px; text-align: center; }

        /* Bottom Nav */
        nav { position: fixed; bottom: 0; width: 100%; background: #161b2c; display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #2d3748; z-index: 1000; }
        .nav-item { color: var(--text-dim); text-decoration: none; font-size: 0.7rem; display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; }
        .nav-item.active { color: var(--primary); }
        .add-btn { background: var(--primary); width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; color: #000; margin-top: -40px; border: 5px solid var(--bg); box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4); }

        /* Modal Overlay */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; align-items: flex-end; }
        .modal-content { background: var(--card); width: 100%; border-radius: 30px 30px 0 0; padding: 30px 20px; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        
        input, select { width: 100%; padding: 15px; margin: 10px 0; background: #0b0f19; border: 1px solid #2d3748; color: white; border-radius: 12px; font-size: 1rem; }
        .submit-btn { background: var(--primary); color: #000; border: none; padding: 18px; width: 100%; border-radius: 15px; font-weight: bold; font-size: 1rem; margin-top: 10px; }
    </style>
</head>
<body>

<header>
    <div class="user-greet">×©×œ×•×, ×‘×•×¢×– ×¡×¢×“×” ğŸ‘‹</div>
    <h1 class="brand">BS Finance Pro</h1>
</header>

<div class="balance-card">
    <div class="balance-label">×™×ª×¨×” ×¤× ×•×™×” ×œ×©×™××•×©</div>
    <div class="balance-val" id="totalBalance">â‚ª0</div>
    <div id="forecastBrief" style="font-size: 0.8rem; opacity: 0.9;"></div>
</div>

<div class="quick-stats">
    <div class="stat-box">
        <div class="icon-circle" style="background: rgba(16, 185, 129, 0.2); color: var(--primary);">â†“</div>
        <div><small style="color:var(--text-dim)">×”×›× ×¡×•×ª</small><br><strong id="incStat" style="color:var(--primary)">â‚ª0</strong></div>
    </div>
    <div class="stat-box">
        <div class="icon-circle" style="background: rgba(244, 63, 94, 0.2); color: var(--danger);">â†‘</div>
        <div><small style="color:var(--text-dim)">×”×•×¦××•×ª</small><br><strong id="expStat" style="color:var(--danger)">â‚ª0</strong></div>
    </div>
</div>

<div id="homeView" class="view-section active">
    <div class="list-title">
        <h3>×ª× ×•×¢×•×ª ××—×¨×•× ×•×ª</h3>
        <small style="color:var(--primary)" onclick="switchTab('tx')">×¨××” ×”×›×œ</small>
    </div>
    <div id="recentList"></div>
</div>

<div id="txView" class="view-section">
    <h3>×”×™×¡×˜×•×¨×™×™×ª ×ª× ×•×¢×•×ª ××œ××”</h3>
    <div id="fullList"></div>
</div>

<div id="forecastView" class="view-section">
    <h3>×ª×—×–×™×ª ×ª×–×¨×™× 3 ×—×•×“×©×™×</h3>
    <div id="forecastFull"></div>
    <div style="background: var(--card); padding: 15px; border-radius: 18px; margin-top: 20px;">
        <p style="font-size: 0.8rem; color: var(--text-dim);">* ×”×ª×—×–×™×ª ××‘×•×¡×¡×ª ×¢×œ ×”×›× ×¡×•×ª ×•×”×•×¦××•×ª ×©×”×’×“×¨×ª ×›"×§×‘×•×¢×•×ª" (×›××• ××©×›× ×ª×, ×”×œ×•×•××•×ª ×•××©×›×•×¨×ª).</p>
    </div>
</div>

<div class="modal" id="addModal">
    <div class="modal-content">
        <h2 style="margin:0 0 20px 0; text-align:center;">×”×•×¡×¤×ª ×¤×¢×•×œ×”</h2>
        <input type="text" id="mDesc" placeholder="×ª×™××•×¨ (×œ××©×œ: ×¡×•×¤×¨, ×”×œ×•×•××ª ×¨×›×‘)">
        <input type="number" id="mSum" placeholder="×¡×›×•× ×‘-â‚ª">
        
        <select id="mType">
            <option value="income">×”×›× ×¡×” ğŸ’°</option>
            <option value="expense">×”×•×¦××” ğŸ’¸</option>
        </select>
        
        <select id="mFreq">
            <option value="once">×—×“-×¤×¢××™ ×”×—×•×“×©</option>
            <option value="fixed">×”×•×¦××”/×”×›× ×¡×” ×§×‘×•×¢×” (×›×œ ×—×•×“×©)</option>
        </select>

        <button class="submit-btn" onclick="saveData()">×©××•×¨ ×¤×¢×•×œ×” âœ¨</button>
        <button onclick="toggleModal(false)" style="background:none; border:none; color:var(--text-dim); width:100%; margin-top:15px;">×¡×’×•×¨</button>
    </div>
</div>

<nav>
    <div class="nav-item active" onclick="switchTab('home')" id="tab-home">
        <span>ğŸ </span><span>×‘×™×ª</span>
    </div>
    <div class="nav-item" onclick="switchTab('tx')" id="tab-tx">
        <span>ğŸ“‹</span><span>×ª× ×•×¢×•×ª</span>
    </div>
    <div class="add-btn" onclick="toggleModal(true)">+</div>
    <div class="nav-item" onclick="switchTab('forecast')" id="tab-forecast">
        <span>ğŸ”®</span><span>×ª×—×–×™×ª</span>
    </div>
    <div class="nav-item" onclick="if(confirm('×œ××¤×¡ × ×ª×•× ×™×?')) {localStorage.clear(); location.reload();}">
        <span>âš™ï¸</span><span>××™×¤×•×¡</span>
    </div>
</nav>

<script>
    let db = JSON.parse(localStorage.getItem('bs_mobile_v8') || '[]');

    function toggleModal(show) {
        document.getElementById('addModal').style.display = show ? 'flex' : 'none';
    }

    function switchTab(tab) {
        document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        
        document.getElementById(tab + 'View').classList.add('active');
        document.getElementById('tab-' + tab).classList.add('active');
        render();
    }

    function saveData() {
        const desc = document.getElementById('mDesc').value;
        const val = parseFloat(document.getElementById('mSum').value);
        const type = document.getElementById('mType').value;
        const freq = document.getElementById('mFreq').value;

        if(!desc || !val) return alert("××œ× ×ª×™××•×¨ ×•×¡×›×•×");

        db.unshift({ desc, val, type, freq, date: new Date().toLocaleDateString('he-IL') });
        localStorage.setItem('bs_mobile_v8', JSON.stringify(db));
        
        document.getElementById('mDesc').value = '';
        document.getElementById('mSum').value = '';
        toggleModal(false);
        render();
    }

    function render() {
        let inc = 0, exp = 0, fInc = 0, fExp = 0;
        const recent = document.getElementById('recentList');
        const full = document.getElementById('fullList');
        const foreFull = document.getElementById('forecastFull');
        
        recent.innerHTML = '';
        full.innerHTML = '';
        
        db.forEach((item, idx) => {
            const isInc = item.type === 'income';
            if(isInc) { inc += item.val; if(item.freq==='fixed') fInc += item.val; }
            else { exp += item.val; if(item.freq==='fixed') fExp += item.val; }

            const html = `
                <div class="tx-item">
                    <div class="tx-info">
                        <h4>${item.desc}</h4>
                        <small>${item.date} ${item.freq==='fixed' ? 'â€¢ ×§×‘×•×¢' : ''}</small>
                    </div>
                    <div style="color:${isInc ? 'var(--primary)' : 'var(--danger)'}; font-weight:bold;">
                        ${isInc ? '+' : '-'}${item.val.toLocaleString()} â‚ª
                    </div>
                </div>
            `;
            if(idx < 5) recent.innerHTML += html;
            full.innerHTML += html;
        });

        document.getElementById('totalBalance').innerText = `â‚ª${(inc - exp).toLocaleString()}`;
        document.getElementById('incStat').innerText = `â‚ª${inc.toLocaleString()}`;
        document.getElementById('expStat').innerText = `â‚ª${exp.toLocaleString()}`;

        // Forecast
        foreFull.innerHTML = '';
        let balance = inc - exp;
        for(let i=1; i<=3; i++) {
            if(i > 1) balance += (fInc - fExp);
            foreFull.innerHTML += `
                <div class="forecast-card">
                    <div style="font-size:0.8rem; opacity:0.7;">×™×ª×¨×” ×¦×¤×•×™×” ×‘×¢×•×“ ${i} ×—×•×“×©×™×</div>
                    <div style="font-size:1.5rem; font-weight:800; color:${balance < 0 ? 'var(--danger)' : 'var(--primary)'}">â‚ª${balance.toLocaleString()}</div>
                </div>
            `;
            if(i === 1) document.getElementById('forecastBrief').innerText = `×ª×—×–×™×ª ×—×•×“×© ×”×‘×: â‚ª${balance.toLocaleString()}`;
        }
    }

    render();
</script>

</body>
</html>
